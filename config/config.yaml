# LLM 설정
llm:
  model: "gpt-4"
  temperature: 0.7
  max_tokens: 2000

# 임베딩 설정
embedding:
  model: "yjoonjang/colbert-ko-v1"
  dimension: 384

# Retriever 설정
retriever:
  top_k_initial: 5
  top_k_secondary: 10
  similarity_threshold: 0.7
  max_loop_count: 1
  
  # Vector 검색 가중치
  vector_weight: 0.7
  keyword_weight: 0.3

# 프롬프트 템플릿
prompts:
  # 쿼리 재작성 - 키워드 추출
  query_refine: |
    다음 사용자 질문을 교학팀 규정 검색에 적합한 키워드 형태로 정제해주세요.
    핵심 키워드만 추출하고, 불필요한 조사나 어미는 제거해주세요.

    질문: {query}

    정제된 검색어:

  # HyDE (Hypothetical Document Embedding) - 가상 문서 생성
  hyde_generation: |
    다음 질문에 대해 대학 학사 규정 문서에서 찾을 수 있을 법한
    이상적인 답변 내용을 작성해주세요. 실제 규정 문서처럼 작성해주세요.

    질문: {query}

    규정 내용:

  # 유용성 평가
  helpfulness_evaluation: |
    다음 질문과 검색된 문서들을 분석하여 문서들이 질문에 답변하는데 유용한지 평가해주세요.

    질문: {query}

    검색된 문서들:
    {documents}

    평가 기준:
    1. 문서가 질문의 주제와 관련이 있는가?
    2. 문서에 질문에 답변할 수 있는 정보가 포함되어 있는가?
    3. 답변을 생성하기에 충분한 정보가 있는가?

    다음 형식으로 응답해주세요:
    유용성: [예/아니오]
    이유: [평가 이유]

  # 근거 검증
  grounding_verification: |
    다음 질문에 대해 검색된 문서들이 답변의 근거로 충분한지 검증해주세요.

    질문: {query}

    검색된 문서들:
    {documents}

    검증 기준:
    1. 문서에 질문에 직접 답변할 수 있는 정보가 있는가?
    2. 답변이 문서 내용에서 직접 도출될 수 있는가?
    3. 추측이나 외부 지식 없이 답변이 가능한가?
    4. 질문이 사용자의 개인 정보(학적상태, 이수현황 등)에 따라 답이 달라지는가?

    다음 형식으로 응답해주세요:
    근거충분: [예/아니오]
    개인정보필요: [예/아니오]
    근거문서: [근거가 되는 문서 번호들, 쉼표로 구분. 예: 1, 3]
    이유: [검증 이유]

  # 답변 생성 (Direct Response Generation)
  answer_generation: |
    다음 규정 정보를 바탕으로 사용자 질문에 정확하게 답변해주세요.
    답변은 반드시 제공된 문서 내용에 근거해야 합니다.

    사용자 질문: {query}

    관련 규정:
    {context}

    답변 지침:
    1. 문서에 근거한 정확한 정보만 제공하세요.
    2. 확실하지 않은 내용은 언급하지 마세요.
    3. 관련 규정 조항이 있다면 인용해주세요.
    4. 친절하고 명확한 톤으로 답변하세요.

    답변:

  # 조건부 응답 (Conditional Response Generation)
  # 개인정보가 필요한 질문에 대해 경우의 수별 예시로 답변
  conditional_response: |
    다음 질문은 사용자의 개인정보(학적 상태, 이수 현황 등)에 따라 답변이 달라집니다.
    개인정보를 직접 묻는 대신, 대표적인 예시를 들어 설명해주세요.

    질문: {query}

    관련 규정:
    {context}

    답변 작성 지침:
    1. 먼저 질문에 대한 일반적인 답변 방향을 설명
    2. 구체적인 예시를 제시 (예: 석사의 경우, 박사의 경우)
    3. 각 경우에 해당하는 구체적인 기준/수치를 명시
    4. 마지막에 "본인의 상황에 맞게 확인해주세요" 등의 안내 추가
    5. 친절하고 이해하기 쉬운 톤으로 작성

    조건부 응답: